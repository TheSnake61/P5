{% extends 'base.html.twig' %}

{% block body %}

<article>
    {% if is_granted('ROLE_ADMIN') %}
    <a href="{{ path('article_edit', {'id': article.id}) }}" class="btn btn-primary">Modifier</a>
    <a href="{{ path('article_delete', {'id': article.id}) }}" class="btn btn-danger" id="deletearticle">Supprimer</a>
    {% endif %}
    <h2>{{ article.title }}</h2>
    <div class="metadata">ecrit le {{ article.createdAt | date('d/m/y') }} à {{ article.createdAt | date('H:i') }}</div>
    <hr class="my-4">
    <div class="content">
        <img src="{{  asset('images/' ~ article.imageFilename) }}" class="img-fluid rounded mx-auto" alt="">
        <div id="spacer"></div>
        {{ article.content | raw }}
    </div>
</article>

<div id="spacer"></div>

<section id="comments">
    <h1>Commentaires :</h1>
    <hr class="my-1">
    {% for comment in article.comments %}
        <div class="comment">
            <div class="row">
                <div class="col-3">
                    {{comment.author}} (<small>{{comment.createdAt | date('d/m/Y à H:i')}}</small>)
                </div>
                <div class="col">
                    {{comment.content | raw}}
                </div>
            </div>
        </div>
        <hr class="my-2">
    {% endfor %}

    <div id="spacer"></div>
    
    <h1>Ajouter un commentaire :</h1>
    {% if app.user %}
        {{ form_start(commentForm) }}
        
        {{ form_row(commentForm.content, {'label': 'Commentaire', 'attr': {'placeholder': 'Commentaire'}}) }}
        <button type="submit" class="btn btn-success">Commenter</button>
        {{ form_end(commentForm) }}
    {% else %}
        <p>Vous devez vous connecter pour commenter</p>
        <a href="{{path('security_login')}}" class="btn btn-primary">Connexion</a>
    {% endif %}

</section>

{% endblock %}

{% block javascripts %}
   <script src="{{ asset('js/deletearticle.js') }}"></script>
{% endblock %}